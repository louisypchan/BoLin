<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
    <div id="test">
        I'm running...
    </div>
</body>
<script type="text/javascript" src="../../bl.js" vecfg="debug:1"></script>
<script type="text/javascript">
    $.use(["bl/core/deferred", "bl/core/when"], function(Deferred, when){
        function asyncProcess(){
            var deferred = new Deferred();
            //document.getElementById("test").innerHTML = "I'm running...";

            setTimeout(function(){
                deferred.resolve("asyncProcess");
            }, 3000);

            return deferred.promise;
        }

        function asyncProcess2(){
            var deferred = new Deferred();
            //document.getElementById("test").innerHTML = "I'm running...";

            setTimeout(function(){
                deferred.resolve("asyncProcess2");
            }, 1000);
            return deferred.promise;
        }



        when(asyncProcess(), asyncProcess2()).then(function(results){
            document.getElementById("test").innerHTML = "I'm finished, and the result was: ";
        });
    });

//    $.use(["bl/core/compiler", "bl/dom/dom"], function(compile, dom){
////        var test = dom("#test");
////        compile(test);
//          dom("#testa").wrap("<span></span>");
//    });
</script>
</html>